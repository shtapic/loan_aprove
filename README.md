# üè¶ –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞ ‚Äî End-to-End ML-–ø—Ä–æ–µ–∫—Ç (Classic ML + PyTorch MLP)

–ü–æ–ª–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è **–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ–¥–æ–±—Ä–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞**, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ [Kaggle Loan Prediction](https://www.kaggle.com/competitions/playground-series-s4e10).

–ü—Ä–æ–µ–∫—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç **–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ ML-–º–æ–¥–µ–ª–∏** (Random Forest, Logistic Regression, LightGBM, —Å—Ç–µ–∫–∏–Ω–≥) –∏ –ø—Ä–æ—Å—Ç—É—é **–Ω–µ–π—Ä–æ—Å–µ—Ç—å MLP –Ω–∞ PyTorch**.
–í—Å—ë –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–æ –º–æ–¥—É–ª—å–Ω–æ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ, —Å –ø—Ä–∏—Ü–µ–ª–æ–º –Ω–∞ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ.
    
### LightGBM Classifier Configuration
Best score:

    Public Score: 0.95672

    Private score: 0.95677
    
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ–¥–∏–Ω –∏–∑ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö ML-–±–µ–π–∑–ª–∞–π–Ω–æ–≤.  
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ –∫–ª–∞—Å—Å–æ–≤.

| Parameter | Value |
|------------|--------|
| **boosting_type** | `'gbdt'` |
| **num_leaves** | `31` |
| **max_depth** | `-1` |
| **learning_rate** | `0.1` |
| **n_estimators** | `100` |
| **subsample_for_bin** | `200000` |
| **objective** | `None` |
| **class_weight** | `'balanced'` |
| **min_split_gain** | `0.0` |
| **min_child_weight** | `0.001` |
| **min_child_samples** | `20` |
| **subsample** | `1.0` |
| **subsample_freq** | `0` |
| **colsample_bytree** | `1.0` |
| **reg_alpha** | `0.0` |
| **reg_lambda** | `0.0` |
| **random_state** | `42` |
| **n_jobs** | `-1` |
| **importance_type** | `'split'` |


---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ data/
‚îÇ  ‚îú‚îÄ train.csv
‚îÇ  ‚îî‚îÄ test.csv
‚îú‚îÄ src/
‚îÇ  ‚îú‚îÄ classic_ml/             # –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ ML-–ø–∞–π–ø–ª–∞–π–Ω—ã, –ø–æ–∏—Å–∫, –æ—Ü–µ–Ω–∫–∞, —Å—Ç–µ–∫–∏–Ω–≥
‚îÇ  ‚îÇ  ‚îú‚îÄ pipeline.py          # make_pipelines
‚îÇ  ‚îÇ  ‚îú‚îÄ grid_search.py       # grid_search
‚îÇ  ‚îÇ  ‚îú‚îÄ evaluate_pipes.py    # evaluate_pipes
‚îÇ  ‚îÇ  ‚îî‚îÄ staking.py           # build_and_fit_stacking
‚îÇ  ‚îú‚îÄ data_and_preprocessors/ # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã
‚îÇ  ‚îÇ  ‚îú‚îÄ data.py              # load_data(train_path, test_path)
‚îÇ  ‚îÇ  ‚îî‚îÄ preprocessors.py     # ColumnTransformer builders
‚îÇ  ‚îî‚îÄ mlp/                    # PyTorch MLP, –æ–±—É—á–µ–Ω–∏–µ, –≥—Ä–∞—Ñ–∏–∫–∏
‚îÇ     ‚îú‚îÄ mlp_model.py
‚îÇ     ‚îú‚îÄ mlp_prepare_data.py  # mlp_prepare_data
‚îÇ     ‚îú‚îÄ mlp_pipeline.py      # make_mlp_pipeline
‚îÇ     ‚îú‚îÄ train_mlp.py         # train_all_mlps
‚îÇ     ‚îú‚îÄ plot_mlp_training_loss.py # plot_mlp_training_loss
‚îÇ     ‚îî‚îÄ evaluate_mlp.py      # evaluate_mlp, evaluate_mlps
‚îú‚îÄ config.py                   # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (LR, NUM_EPOCHS, RANDOM_STATE, TRAIN_PATH, TEST_PATH)
‚îú‚îÄ models/                    # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
‚îú‚îÄ .env                       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ requirements.txt
‚îú‚îÄ main.ipynb
‚îî‚îÄ README.md
```

---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* Python **3.10‚Äì3.12**
* –û–°: **Windows**, **Linux** –∏–ª–∏ **macOS**
* –§–∞–π–ª—ã `train.csv` –∏ `test.csv` –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `data/`

---

## üß© –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞:

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1        # (Windows)
# source .venv/bin/activate         # (Linux/Mac)
pip install --upgrade pip
pip install -r requirements.txt
```



–ó–∞–≥—Ä—É–∑–∫–∞ –≤ –∫–æ–¥–µ:

```python
from dotenv import load_dotenv
load_dotenv()
```

–ï—Å–ª–∏ –≤ Jupyter –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –º–æ–¥—É–ª–∏ `src`, –¥–æ–±–∞–≤—å—Ç–µ –ø—É—Ç—å –≤—Ä—É—á–Ω—É—é:

```python
import sys, os
sys.path.insert(0, os.path.abspath('src'))
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ß–µ—Ä–µ–∑ Jupyter Notebook

1. –û—Ç–∫—Ä–æ–π—Ç–µ `main.ipynb` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)
2. –í—ã–ø–æ–ª–Ω—è–π—Ç–µ —è—á–µ–π–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É:

#### **1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**

* `src/data_and_preprocessors/data.py:load_data(train_path, test_path)` ‚Äî –ø—É—Ç–∏ —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ `config.py`
* –î–µ–ª–∏—Ç –≤—ã–±–æ—Ä–∫—É `train/test`
* –ü—Ä–∏–º–µ–Ω—è–µ—Ç `ColumnTransformer` –∫ —á–∏—Å–ª–æ–≤—ã–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º

#### **2Ô∏è‚É£ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ ML-–º–æ–¥–µ–ª–∏**

* –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤: `src/classic_ml/pipeline.py:make_pipelines`
* –ü–æ–∏—Å–∫ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: `src/classic_ml/grid_search.py:grid_search`
* –°—Ç–µ–∫–∏–Ω–≥: `src/classic_ml/staking.py:build_and_fit_stacking`
* –û—Ü–µ–Ω–∫–∞: `src/classic_ml/evaluate_pipes.py:evaluate_pipes`

#### **3Ô∏è‚É£ MLP (PyTorch)**

* –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö: `src/mlp/mlp_prepare_data.py:mlp_prepare_data`

  * —Ñ–∏—Ç–∏–Ω–≥ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ —Ç–æ–ª—å–∫–æ –Ω–∞ train
  * –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `train_loader`, `test_loader`, –≤–µ—Å–∞ –¥–ª—è BCE (`weight`), `input_dim`
* –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏: `src/mlp/mlp_pipeline.py:make_mlp_pipeline`
* –û–±—É—á–µ–Ω–∏–µ: `src/mlp/train_mlp.py:train_all_mlps`
* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: `src/mlp/mlp_graph.py:plot_mlp_training_loss`

---

## üß† –û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–∏

* **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥** —á–µ—Ä–µ–∑ `ColumnTransformer`
* **–°—Ç–µ–∫–∏–Ω–≥** –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π
* **–ü—Ä–æ—Å—Ç–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å MLP** –∫–∞–∫ –±–µ–π–∑–ª–∞–π–Ω –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
* **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (CPU/GPU)**
* **–ü–æ–ª–Ω–∞—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å** –∑–∞ —Å—á—ë—Ç –µ–¥–∏–Ω–æ–≥–æ `.env`

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞                       | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                                                                            | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è                                      |
| ----------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------- |
| **Balanced Accuracy**         | –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Ç—ã (Recall) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞. –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤, –ø–æ–∫–∞–∑—ã–≤–∞—è, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã. | 1.0 ‚Äî –∏–¥–µ–∞–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è; 0.5 ‚Äî —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ.   |
| **F1-macro**                  | –°—Ä–µ–¥–Ω–µ–µ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ –º–µ–∂–¥—É precision –∏ recall, —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω–æ–µ –ø–æ –∫–ª–∞—Å—Å–∞–º. –ù–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ –¥–∏—Å–±–∞–ª–∞–Ω—Å—É, –æ—Ç—Ä–∞–∂–∞–µ—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É ¬´—á–∏—Å—Ç–æ—Ç–æ–π¬ª –∏ ¬´–ø–æ–ª–Ω–æ—Ç–æ–π¬ª –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.                  | –ß–µ–º –≤—ã—à–µ, —Ç–µ–º –ª—É—á—à–µ; –º–∞–∫—Å–∏–º—É–º = 1.                 |
| **ROC-AUC**                   | –ü–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π (True Positive Rate vs False Positive Rate). –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ —Ä–∞–∑–ª–∏—á–∞—Ç—å –∫–ª–∞—Å—Å—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞.                                 | 1 ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ; 0.5 ‚Äî —Å–ª—É—á–∞–π–Ω–æ–µ —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ.          |
| **Average Precision (macro)** | –ü–ª–æ—â–∞–¥—å –ø–æ–¥ PR-–∫—Ä–∏–≤–æ–π (Precision-Recall), —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω–∞—è –ø–æ –∫–ª–∞—Å—Å–∞–º. –ë–æ–ª–µ–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ –∫–ª–∞—Å—Å–æ–≤.                                                               | 1 ‚Äî –∏–¥–µ–∞–ª—å–Ω—ã–π precision/recall; –±–ª–∏–∂–µ –∫ 0 ‚Äî –ø–ª–æ—Ö–æ. |
| **Log-loss**                  | –°—Ä–µ–¥–Ω—è—è –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è –ø–æ—Ç–µ—Ä—è –º–µ–∂–¥—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ –∏—Å—Ç–∏–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏. –°—Ç—Ä–æ–≥–æ –Ω–∞–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞ —É–≤–µ—Ä–µ–Ω–Ω—ã–µ, –Ω–æ –Ω–µ–≤–µ—Ä–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã.                                          | –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ; –∏–¥–µ–∞–ª = 0.                  |
                                         | –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ; –∏–¥–µ–∞–ª = 0.                  |


–î–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```python
roc_auc_score(y_true, model.predict_proba(X)[:, 1])
```

---

## üß≠ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

* [ ] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –¥–ª—è Classic ML –∏ MLP
* [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –º–æ–¥–µ–ª–∏ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ `MODEL_DIR`
* [ ] –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –∏ –æ—Ü–µ–Ω–∫–∏
* [ ] –°–æ–∑–¥–∞—Ç—å CLI-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ Hydra
* [ ] –£–ø–∞–∫–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∫–∞–∫ Python-–ø–∞–∫–µ—Ç (`pyproject.toml`)

---

## üßÆ –û –¥–∞—Ç–∞—Å–µ—Ç–µ

–î–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Ç–∏–ø–∏—á–Ω—É—é –∑–∞–¥–∞—á—É –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞:
–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞—è–≤–∏—Ç–µ–ª—è —É–∫–∞–∑–∞–Ω—ã —Å–æ—Ü–∏–∞–ª—å–Ω–æ-–¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –¥–æ—Ö–æ–¥, —Ä–∞–∑–º–µ—Ä –∑–∞–π–º–∞, —Ç–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –∏ –ø—Ä.
–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚Äî **Loan_Status** (`Y`), –±–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫: –∫—Ä–µ–¥–∏—Ç –æ–¥–æ–±—Ä–µ–Ω –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω—ë–Ω.

---



## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

    MIT

